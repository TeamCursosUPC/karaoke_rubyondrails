
<h1>Productos</h1>
<h1><%= @q %></h1>

<div style = "display:none">
	<%= @idpedido=Request.maximum("id") %>
</div>

<label  for="selectbasic" >Seleccionar Local:</label>
<select id="selectbasic" name="selectbasic" class="form-control" onchange="this.form.submit()">
  <% @local.each do |local| %>  
    <option value="1">
        <%= local.nombre %>
    </option>
  <% end %>
</select>

<%= bootstrap_form_for(@detailRequestProduct) do |f| %>
  <%= f.text_field :descripcion, label: "N° Pedido:", value: @idpedido, :disabled => true %>
  <%= f.collection_select :product_id, Product.all, :id, :nombre, label: "Seleccione Producto:" %>
  <%= f.text_field :cantidad, label: "Ingrese Cantidad:" %>
  <%= f.submit "Hacer pedido", class: "btn btn-success" %>
<% end %>


    <br>
<br>
<br>
<br>

   <h3>Detalle de Pedido</h3>
        <div class="col-sm-12 col-md-10 col-md-offset-1">
          <table class="table table-hover" cellspacing="0" width="100%">
            <thead>
              <tr >
                <th>#</th>
                <th>Producto</th>
                <th>Cantidad</th>
                <th>Precio (Unidad)</th>
                <th>Eliminar</th>
              </tr>
            </thead>

            <tbody>
            <% @totalpedido=0 %>
            <% @detailRequestProductAll.each do |detailRequestProduct| %>
                <% @totalpedido=@totalpedido+(detailRequestProduct.cantidad * detailRequestProduct.product.precio) %>
                <tr>
                  <td><%= detailRequestProduct.id %></td>
                  <td><h4 class="media-heading"><%= detailRequestProduct.product.nombre %></a></td>
                  <td><%= detailRequestProduct.cantidad %></td>
                  <td><%= detailRequestProduct.product.precio %></td>
                  <td align="center" class="col-sm-1 col-md-1">
                    <%= link_to(detailRequestProduct, method: :delete ) do %>
                        <p data-placement="top" data-toggle="tooltip" title="Delete" >
                          <button class="btn btn-danger" data-title="Delete" data-toggle="modal" >
                            <span class="glyphicon glyphicon-remove"></span>
                          </button>
                        </p>
                    <% end %>
                  </td>
                </tr>
            <% end %>
                <% puts "DEBUG --------------> #{@totalpedido}" %>
                <tr>
                    <td>   </td>
                    <td>   </td>
                    <td>   </td>
                    <td><h3>Total</h3></td>
                    <td class="text-right"><h3><strong><% @totalpedido %></strong></h3></td>
                </tr>
                    <tr>
                        <td>   </td>
                        <td>   </td>
                        <td>   </td>
                        <td>
                        <button type="button" class="btn btn-default">
                            <span class="glyphicon glyphicon-shopping-cart"></span> Continue Shopping
                        </button></td>
                        <td>
                        <button type="button" class="btn btn-success">
                            Checkout <span class="glyphicon glyphicon-play"></span>
                        </button></td>
                    </tr>
            </table>
            </tbody>
          </table>
          <% @totalpedido %>
          <h1><% @totalpedido.to_s %></h1>
